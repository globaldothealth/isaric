#:schema ../../schemas/dev/parser.schema.json

[adtl]
  name = "datcov-southafrica"
  description = "South Africa DATCOV study"

  [adtl.tables.study]
    kind = "constant"

  [adtl.tables.subject]
    kind = "oneToOne"
    schema = "../../schemas/dev/subject.schema.json"

  [adtl.tables.visit]
    kind = "oneToOne"
    schema = "../../schemas/dev/visit.schema.json"

  [adtl.tables.observation]
    kind = "oneToMany"
    aggregation = "lastNotNull"
    schema = "../../schemas/dev/observation.schema.json"

  [adtl.defs."Y/N/NK".values] # hoping this works ...
    1 = true
    0 = false

[adtl.defs.subjectId]
  combinedType = "firstNonNull"
  fields = [{ field = "PatientId" }, { field = "NICDCaseID" }]
  sensitive = true

[adtl.defs.admissionDateHierarchy]
  combinedType = "firstNonNull"
  fields = [
    { field = "Adm Date.AdmissionDate", source_date = "%m/%d/%y" },
    { field = "date_of_admis_datcov" },
    { field = "flw_hospital_admit", description = "Roughly what date were you first admitted to hospital?" },
  ]

[adtl.defs.followupDateHierarchy]
  combinedType = "firstNonNull"
  fields = [
    { field = "flw_survey_date", description = "Date you did the survey (DD/MM/YYYY):" },
    { field = "flw_date_symptoms", description = "Roughly at what date did you first experience symptoms of COVID-19?" },
    { field = "flw_date_symptoms_2", description = "Roughly what date did you have the COVID-19 antibody test?" },
  ]

[adtl.defs.inabilityWalk.values]
  2 = "slight"
  3 = "moderate"
  4 = "severe"
  5 = "unable"

[study]
  id = "datcov-southafrica"
  date = ""                 # to be filled
  country_iso3 = "ZAF"      # correct ?

[subject]
  study_id = "datcov-southafrica" # ?? to be filled
  country_iso3 = "ZAF"
  pathogen = "COVID-19"

  [subject.subject_id]
    ref = "subjectId"

    # [subject.enrolment_date] # CompletedDate not found
    #   field = "CompletedDate"
    #   description = "Date this form was completed" # patient form

  [subject.enrolment_date]
    ref = "admissionDateHierarchy"

  [subject.age]
    field = "Age"

  [subject.sex_at_birth]
    field = "BirthSex"
    description = "Sex at birth"
    values = { Male = "male", Female = "female" }

  [subject.ethnicity]
    combinedType = "set"
    excludeWhen = "none"
    fields = [
      { field = "EthnicGroup" },                                                                 # text / check box field for the acute infection data; # values in the data: ['Black African', 'Coloured', 'Unknown', 'Indian', 'White', 'Other']
      { field = "ethnic", values = { 1 = "Black", 2 = "White", 3 = "Indian", 4 = "Coloured" } },
    ]


  [subject.admission_date]
    ref = "admissionDateHierarchy"

  [subject.works_healthcare]
    combinedType = "any"
    fields = [
      { field = "HealthcareWorker", values = { true = true, false = false } }, # values in the data: ['true', 'false']
      { field = "healthwork_erterm", values = { 1 = true, 0 = false } },
    ]
    description = "Is the patient a healthcare worker?"

  [subject.works_microbiology_lab]
    field = "healthwork_type"
    values = { 1 = false, 2 = false, 3 = false, 4 = true, 5 = false, 6 = false, 7 = false, 8 = false, 9 = false, 10 = false }
    description = "Is the patient a healthcare worker?"

  [subject.pregnancy] # pregnancy fields not in the data?
    field = "PregnancyStatus"
    description = "If female patient, select pregnancy status"
    values = { 'Yes' = true, 'No' = false }                    # is this correct?
    # values in the data = ['No', 'Yes']

  [subject.has_asplenia]
    field = "flw_ongoing_chronic_list___10"
    ref = "Y/N/NK"
    description = "Asplenia"

  [subject.has_tuberculosis]
    combinedType = "any"
    fields = [
      { field = "Tuberculosis Active", values = { 'Yes' = true, 'No' = false } }, # values = ['No', 'Unknown', 'Yes', 'UNKNOWN', nan]
      { field = "flw_ongoing_chronic_list___20", ref = "Y/N/NK" },
    ]

  [subject.has_dementia]
    field = "flw_ongoing_chronic_list___15"
    ref = "Y/N/NK"
    description = "Dementia"

  [subject.has_rheumatologic_disorder]
    field = "flw_ongoing_chronic_list___13"
    ref = "Y/N/NK"
    description = "Rhemumatologic disorder"

  [subject.has_hiv]
    combinedType = "any"
    fields = [
      { field = "HIV Positive", values = { 'Yes' = true, 'No' = false } }, # values = ['No', 'Unknown', 'Yes', nan]}
      { field = "flw_ongoing_chronic_list___16", ref = "Y/N/NK" },
    ]

  [subject.has_obesity]
    field = "Obesity"
    values = { 'Yes' = true, 'No' = false }
    # values = ['No', 'Unknown', 'Yes', nan]

  [subject.has_hypertension]
    combinedType = "any" # Q. is this the correct type?
    fields = [
      { field = "Hypertension", values = { 'Yes' = true, 'No' = false } }, # values = ['Unknown', 'No', 'Yes', nan]
      { field = "flw_comp_hpt", values = { 1 = true, 0 = false } },
      # { field = "flw2_comp_hpt", values = { 1 = true, 0 = false } },
    ]

  [subject.has_malignant_neoplasm]
    field = "Malignancy"
    values = { 'Yes' = true, 'No' = false }
    # values = ['No', 'Unknown', 'UNKNOWN', 'Yes', nan]

  [subject.has_smoking]
    combinedType = "firstNonNull"
    fields = [
      { field = "Smoking", values = { "Never smoked" = "never", "Current smoker" = "yes", "Former smoker" = "former" } }, # this is a text field; values = ['Unknown', 'Never smoked', 'Current smoker', 'Former smoker']
      { field = "flw_smok_before", values = { 1 = "former", 2 = "yes", 3 = "never" } },
    ]

  [subject.has_asthma]
    combinedType = "any"
    fields = [
      { field = "Asthma", values = { 'Yes' = true, 'No' = false } }, # values = ['No', 'Unknown', 'Yes', 'UNKNOWN', nan]
      { field = "flw_ongoing_chronic_list___3", ref = "Y/N/NK" },
    ]

  [subject.has_chronic_cardiac_disease]
    field = "Cardiac Disease"
    values = { 'Yes' = true, 'No' = false }
    # values = ['No', 'Unknown', 'UNKNOWN', 'Yes', nan]

  [subject.has_chronic_kidney_disease]
    combinedType = "any"
    fields = [
      { field = "Chronic Renal Failure", values = { 'Yes' = true, 'No' = false } }, # values = ['No', 'Unknown', 'UNKNOWN', 'Yes', nan] }
      { field = "flw_ongoing_chronic_list___8", ref = "Y/N/NK" },
    ]

  [subject.has_diabetes]
    combinedType = "any"
    fields = [
      { field = "Diabetes", values = { 'Yes' = true, 'No' = false } },                                              # values = ['No', 'Unknown', 'Yes', 'UNKNOWN', nan]
      { field = "flw_comp_dm", description = "Diabetes Mellitus (Unspecified)", values = { 1 = false, 0 = true } },
      { field = "flw_comp_dm2", description = "Diabetes Mellitus Type 2", values = { 1 = false, 0 = true } },
      # { field = "flw2_comp_dm", description = "Diabetes Mellitus (Unspecified)", values = { 1 = false, 0 = true } },
      # { field = "flw2_comp_dm2", description = "Diabetes Mellitus Type 2", values = { 1 = false, 0 = true } },
      { field = "flw_ongoing_chronic_list___5", ref = "Y/N/NK", description = "Diabetes Type 1" },
      { field = "flw_ongoing_chronic_list___6", ref = "Y/N/NK", description = "Diabetes Type 2" },
      { field = "flw_ongoing_chronic_list___7", ref = "Y/N/NK", description = "Diabetes Gestational" },
    ]
    # can we assume diabetes as a disease was there before COVID? and so the followup data applies here?

  [subject.diabetes_type]
    combinedType = "firstNonNull"
    fields = [
      { field = "flw_comp_dm2", description = "Diabetes Mellitus Type 2", values = { 1 = "type-2" } },
      # { field = "flw2_comp_dm2", description = "Diabetes Mellitus Type 2", values = { 1 = "type-2" } },
      { field = "flw_ongoing_chronic_list___5", values = { 1 = "type-1" } },
      { field = "flw_ongoing_chronic_list___6", values = { 1 = "type-2" } },
      { field = "flw_ongoing_chronic_list___7", values = { 1 = "gestational" } },
    ]

  [subject.has_liver_disease]
    field = "flw_ongoing_chronic_list___9"
    ref = "Y/N/NK"
    description = "Liver disease"

  [subject.has_hiv_viral_suppression]
    field = "HIV Viral Suppression"
    values = { 'Yes' = true, 'No' = false }
    # values = [nan, 'No', 'Unknown', 'Yes']

  [subject.has_tuberculosis_past]
    field = "Tuberculosis Past"
    values = { 'Yes' = true, 'No' = false }
    # values = ['No', 'Unknown', 'Yes', 'UNKNOWN', nan] 

  [subject.has_hiv_art]
    field = "HIV On ART"
    values = { 'Yes' = true, 'No' = false }
    # values = [nan, 'Yes', 'Unknown', 'No']

  [subject.has_immunosuppression_therapy_treatment]
    combinedType = "any"
    fields = [
      { field = "Medication during hospitalisation.ImmunosuppressantAdministered", values = { 0 = false, 1 = true } }, # ['0', 'Unknown', '1']
      { field = "Admission Medications.Immunosuppressants", values = { TRUE = true, FALSE = false } },
    ]

  [subject.has_died]
    field = "dsterm"
    description = "Death occurred"
    values = { 1 = false, 2 = false, 3 = false, 4 = true, 5 = true, 6 = false } # 5 = 'Died (non-COVID)', should this be considered?

  [subject.date_death]
    field = "Date Of Death"
    source_date = "%m/%d/%y"

  [subject.icu_admitted]
    combinedType = "any"
    fields = [
      { field = "Intervention during hospitalisation.IcuAdmission", ref = "Y/N/NK" },                                                                        # values in data = ['0', 'Unknown', '1']
      { field = "Ever ICU", values = { 0 = false, 1 = true } },
      { field = "flw_icu", description = "If ever admitted to hospital, were you admitted to intensive care (ICU/ITU)?", values = { 0 = false, 1 = true } },
    ]

[visit]
  country_iso3 = "ZAF"

  [visit.subject_id]
    ref = "subjectId"

  [visit.visit_id] # to be determined, use subject id for now
    ref = "subjectId"

  [visit.start_date]
    combinedType = "firstNonNull"
    fields = [
      { field = "Adm Date.AdmissionDate", source_date = "%m/%d/%y" },
      { field = "date_of_admis_datcov" },
    ]


  [visit.outcome]
    combinedType = "firstNonNull"

    [[visit.outcome.fields]]
      field = "Discharge Status"

      [visit.outcome.fields.values]
        "Discharged alive" = "discharged"
        "Died" = "death"
        "Transfer to other facility" = "transferred"
        "In Hospital" = "hospitalised"
        "Died (non-COVID)" = "death"                 # TODO: currently not in schema, marking as death

    [[visit.outcome.fields]]
      field = "dsterm"
      values = { 1 = "discharged", 2 = "hospitalised", 3 = "transferred", 4 = "death", 5 = "death" }

[visit.date_outcome]
  combinedType = "firstNonNull"
  fields = [
    { field = "OutcomeDate", source_date = "%m/%d/%y" },
    { field = "date_of_outcome_datcov" },
  ]

  # [visit.end_date] # cant determine this?
  #   field = ""
  #   description = ""

[visit.pathogen_test_date]
  combinedType = "firstNonNull"
  fields = [
    { field = "PosSpecRecDate", source_date = "%m/%d/%y" },
    { field = "PosSpecRepDate", source_date = "%m/%d/%y" },
    { field = "PosSpecColDate", source_date = "%m/%d/%y" },
  ]

[visit.icu_admission]
  field = "Intervention during hospitalisation.IcuAdmission"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.icu_admission_dates]
  combinedType = "set"
  excludeWhen = "none"
  fields = [
    { field = "Intervention during hospitalisation.IcuAdmissionDate", source_date = "%m/%d/%y" },
  ]

[visit.treatment_dialysis]
  combinedType = "any"
  fields = [
    { field = "Intervention during hospitalisation.RenalDialysis", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever RenalDialysis", values = { 0 = false, 1 = true } },
  ]

[visit.treatment_inotropes_vasopressors]
  field = "Intervention during hospitalisation.IntropicSupport"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_ecmo]
  field = "Ever ECMO"
  values = { 0 = false, 1 = true }

[visit.treatment_oxygen_therapy]
  combinedType = "any"
  fields = [
    { field = "Admission Intervention.OnOxygen", values = { FALSE = false, TRUE = true } },
    { field = "Intervention during hospitalisation.SupplementalOxygen", ref = "Y/N/NK" },   # values = ['0', 'Unknown', '1']
    { field = "Ever on oxygen", values = { 0 = false, 1 = true } },
    # { field = "flw2_oxygen_banner", description = "Have you ever received oxygen whilst you were admitted to hospital for COVID?", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_prone_position]
  combinedType = "any"
  fields = [
    { field = "Intervention during hospitalisation.ProneVentilation", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever ProneVentilation", values = { 0 = false, 1 = true } },
  ]

[visit.treatment_invasive_ventilation]
  combinedType = "firstNonNull"
  fields = [
    { field = "Intervention during hospitalisation.InvasiveVentilation", ref = "Y/N/NK" },    # values = ['0', 'Unknown', '1']
    { field = "Ever InvasiveVentilation", values = { 0 = false, 1 = true } },
    { field = "Admission Intervention.Ventilated", values = { FALSE = false, TRUE = true } }, # values = False,  True
    # { field = "flw2_invasive_noninv_banner", values = { 1 = true, 0 = false }, description = "Were you ever ventilated whilst you were admitted to hospital for COVID? (did you need a machine to help you breathe)?" },
  ]

[visit.treatment_antifungal_agent]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.AntifungalAgentAdministered", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Antifungals", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_antivirals]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.AntiviralAgentAdministered", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Antivirals", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_antibiotics]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.AntibioticsAdministered", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Antibiotics", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_anticoagulation]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.Anticoagulants", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Anticoagulants", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_noninvasive_ventilation]
  combinedType = "firstNonNull"
  fields = [
    { field = "Intervention during hospitalisation.NonInvasiveVentilation", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Admission Intervention.Ventilated", values = { FALSE = false, TRUE = true } },
    # { field = "flw2_invasive_noninv_banner", values = { 1 = true, 0 = false }, description = "Were you ever ventilated whilst you were admitted to hospital for COVID? (did you need a machine to help you breathe)?" },
  ]

[visit.treatment_ace_inhibitors]
  field = "Admission Medications.AceInhibitor"
  values = { FALSE = false, TRUE = true }

[visit.treatment_dexamethasone]
  field = "Medication during hospitalisation.Dexamethasone"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_high_flow_nasal_cannula]
  combinedType = "any"
  fields = [
    { field = "Intervention during hospitalisation.HighFlowNasalOxygen", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever HighFlowNasalOxygen", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_steroids]
  combinedType = "any"
  fields = [
    { field = "Admission Medications.Steroids", values = { FALSE = false, TRUE = true } },
    { field = "Medication during hospitalisation.SteroidsAdministered", ref = "Y/N/NK" },  # values = ['0', 'Unknown', '1']
    { field = "Ever Steroids", values = { 1 = true, 0 = false } },                         # values = [0, 1];
  ]

[visit.treatment_immunosuppressant]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.ImmunosuppressantAdministered", ref = "Y/N/NK" },   # values = ['0', 'Unknown', '1']
    { field = "Admission Medications.Immunosuppressants", values = { FALSE = false, TRUE = true } },
    { field = "Ever ImmunosuppressiveDrugs", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_neuraminidase]
  field = "Medication during hospitalisation.Neuraminidase"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_cpr]
  field = "Intervention during hospitalisation.CPR"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_tocilizumab]
  field = "Medication during hospitalisation.Tocilizumab"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_indication_anticoagulation] #Q. is this the same as '[visit.treatment_anticoagulation]'?
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.Anticoagulants", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Anticoagulants", ref = "Y/N/NK" },                              # values = ['0', 'Unknown', '1']
  ]

[visit.treatment_cardiovascular]
  combinedType = "any"
  fields = [
    { field = "Intervention during hospitalisation.CardiovascularSupport", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever CardiovascularSupport", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_colchicine]
  field = "Medication during hospitalisation.Colchicine"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_immunoglobulins]
  combinedType = "any"
  fields = [
    { field = "Medication during hospitalisation.ImmunoglobulinsAdministered", ref = "Y/N/NK" }, # values = ['0', 'Unknown', '1']
    { field = "Ever Immunoglobulin", values = { 1 = true, 0 = false } },
  ]

[visit.treatment_nsaid]
  field = "Ever NonSteroidal"
  values = { 1 = true, 0 = false }

[visit.treatment_oxygen_mechanical_support]
  field = "Intervention during hospitalisation.MechanicalSupport"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

[visit.treatment_pacing]
  field = "Intervention during hospitalisation.Pacing"
  ref = "Y/N/NK"
  # values = ['0', 'Unknown', '1']

  # OBSERVATION - required (phase, name, if and date)

[[observation]]
  name = "history_of_fever"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Fever", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Fever" = { "!=" = 'Unknown' } }          # is this correct?

[[observation]]
  name = "history_of_fever"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_fever_ceoccur_2", values = { 0 = false, 1 = true } } # values = ['0', '1', '3']
  if = { flw_fever_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "history_of_fever"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_fever", values = { 0 = false, 1 = true } } # values = ['0', '1', '2']
  if = { flw_fever = { "!=" = 2 } }

[[observation]]
  name = "history_of_fever"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_fev", values = { 0 = false, 1 = true } }
  if.any = [{ flw_fev = 2 }, { flw_fev = 4 }]

  # [[observation]]
  #   name = "history_of_fever"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_fever", values = { 0 = false, 1 = true } } # values = ['0', '1', '2']
  #   if = { flw2_fever = { "!=" = 2 } }

  # [[observation]]
  #   name = "history_of_fever"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_fev", values = { 0 = false, 1 = true } }
  #   if.any = [{ flw2_fev = 2 }, { flw2_fev = 4 }]

[[observation]]
  name = "cough"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Cough", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Cough" = { "!=" = 'Unknown' } }

[[observation]]
  name = "cough"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_cough_ceoccur_2", values = { 0 = false, 1 = true } } # values = ['0', '1', '3']
  if = { flw_cough_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "cough_with_sputum_production"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_coughsput_ceoccur_2", values = { 0 = false, 1 = true } } # values = ['0', '1', '3']
  if = { flw_coughsput_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "cough_with_haemoptysis"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_coughhb_ceoccur_2", values = { 0 = false, 1 = true } } # values = ['0', '1', '3']
  if = { flw_coughhb_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "shortness_of_breath"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.BreathShortness", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.BreathShortness" = { "!=" = 'Unknown' } }

[[observation]]
  name = "shortness_of_breath"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_shortbreath_ceoccur_2", values = { 0 = false, 1 = true } } # values = ['0', '1', '3']
  if = { flw_shortbreath_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "shortness_of_breath"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_short_breth", values = { 0 = false, 1 = true } }
  if.any = [{ flw_short_breth = 2 }, { flw_short_breth = 4 }]

  # [[observation]]
  #   name = "shortness_of_breath"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_short_breath", values = { 0 = false, 1 = true } }
  #   if.any = [{ flw2_short_breath = 2 }, { flw2_short_breath = 4 }]

[[observation]]
  name = "muscle_aches"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.MuscleAches", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.MuscleAches" = { "!=" = 'Unknown' } }

[[observation]]
  name = "muscle_aches"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_myalgia_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_myalgia_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "muscle_aches"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_muscle_pain", values = { 0 = false, 1 = true } }
  if.any = [{ flw_muscle_pain = 2 }, { flw_muscle_pain = 4 }]

[[observation]]
  name = "fatigue_malaise"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Fatigue", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Fatigue" = { "!=" = 'Unknown' } }          # Q. is this correct?

[[observation]]
  name = "fatigue_malaise"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_fatigue_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_fatigue_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "fatigue_malaise"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_fat_mal", values = { 0 = false, 1 = true } }
  if.any = [{ flw_fat_mal = 2 }, { flw_fat_mal = 4 }]

  # [[observation]]
  #   name = "fatigue_malaise"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_fat_mal", values = { 0 = false, 1 = true } }
  #   if.any = [{ flw2_fat_mal = 2 }, { flw2_fat_mal = 4 }]

[[observation]]
  name = "headache"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Headache", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Headache" = { "!=" = 'Unknown' } }

[[observation]]
  name = "headache"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_headache_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_headache_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "headache"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_headache", values = { 0 = false, 1 = true } }
  if.any = [{ flw_headache = 2 }, { flw_headache = 4 }]

  # [[observation]]
  #   name = "headache"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_headache", values = { 0 = false, 1 = true } }
  #   if.any = [{ flw2_headache = 2 }, { flw2_headache = 4 }]

[[observation]]
  name = "confusion"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Confusion", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Confusion" = { "!=" = 'Unknown' } }

[[observation]]
  name = "confusion"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_confusion_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_confusion_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "confusion"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_confusion", values = { 0 = false, 1 = true } }
  if.any = [{ flw_confusion = 2 }, { flw_confusion = 4 }]

  # [[observation]]
  #   name = "confusion"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_confusion", values = { 0 = false, 1 = true } }
  #   if = { flw2_confusion = { "!=" = 2 } }

[[observation]]
  name = "anorexia"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_appetite_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_appetite_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "anorexia"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "cu_appetite", values = { 0 = false, 1 = true } }
  if = { cu_appetite = { "!=" = 2 } }

[[observation]]
  name = "anorexia"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_appetite", values = { 0 = false, 1 = true } }
  if.any = [{ flw_appetite = 2 }, { flw_appetite = 4 }]

  # [[observation]]
  #   name = "anorexia"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_appetite", values = { 0 = false, 1 = true } }
  #   if.any = [{ flw2_appetite = 2 }, { flw2_appetite = 4 }]

[[observation]]
  name = "vomiting_nausea"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Vomiting", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Vomiting" = { "!=" = 'Unknown' } }

[[observation]]
  name = "vomiting_nausea"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_vomit_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_vomit_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "vomiting_nausea"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_feeling_sick", values = { 1 = true, 0 = false } }
  if.any = [{ flw_feeling_sick = 2 }, { flw_feeling_sick = 4 }]

  # [[observation]]
  #   name = "vomiting_nausea"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_feeling_sick", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_feeling_sick = 2 }, { flw2_feeling_sick = 4 }]

[[observation]]
  name = "diarrhoea"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Admission Symptoms.Diarrhoea", ref = "Y/N/NK" } # values = ['0', 'Unknown', '1']
  if = { "Admission Symptoms.Diarrhoea" = { "!=" = 'Unknown' } }

[[observation]]
  name = "diarrhoea"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_diarrhoea_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_diarrhoea_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "diarrhoea"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_diarrhoea", values = { 1 = true, 0 = false } }
  if.any = [{ flw_diarrhoea = 2 }, { flw_diarrhoea = 4 }]

  # [[observation]]
  #   name = "diarrhoea"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_diarrhoea", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_diarrhoea = 2 }, { flw2_diarrhoea = 4 }]

[[observation]]
  name = "mid_upper_arm_circumference_cm"
  phase = "admission"
  date = { ref = "admissionDateHierarchy" }
  is_present = { field = "Mid-Upper-Arm Circumference" }
  if = { "Mid-Upper-Arm Circumference" = { "!=" = "" } }

[[observation]]
  name = "sore_throat"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_sorethroat_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_sorethroat_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "runny_nose"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_runnynose_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_runnynose_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "wheezing"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_wheeze_ceoccur_2", values = { 0 = false, 1 = true } }
  if = { flw_wheeze_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "chest_pain"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_chestpain_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_chestpain_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "chest_pain"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_chest_pains", values = { 1 = true, 0 = false } }
  if.any = [{ flw_chest_pains = 2 }, { flw_chest_pains = 4 }]

  # [[observation]]
  #   name = "chest_pain"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_chest_pains", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_chest_pains = 2 }, { flw2_chest_pains = 4 }]

[[observation]]
  name = "joint_pain"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_jointpain_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_jointpain_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "joint_pain"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_joint_pain", values = { 1 = true, 0 = false } }
  if.any = [{ flw_joint_pain = 2 }, { flw_joint_pain = 4 }]

  # [[observation]]
  #   name = "joint_pain"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_joint_pain", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_joint_pain = 2 }, { flw2_joint_pain = 4 }]

[[observation]]
  name = "inability_to_walk"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_inablewalk_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_inablewalk_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "inability_to_walk"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_inablewalk_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_inablewalk_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "inability_to_walk"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_eq5d_mb_5l_uk_eng_2", ref = "inabilityWalk" }
  if = { flw_eq5d_mb_5l_uk_eng_2 = { "!=" = 1 } }

[[observation]]
  name = "inability_to_walk"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_walking_today", values = { 2 = true, 3 = true, 4 = true } } # check if this is correct
  if = { flw_walking_today = { "!=" = 1 } }

  # [[observation]]
  #   name = "inability_to_walk"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_eq5d_mb_5l_uk_eng_2", ref = "inabilityWalk" }
  #   if = { flw2_eq5d_mb_5l_uk_eng_2 = { "!=" = 1 } }

  # [[observation]]
  #   name = "inability_to_walk"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_walking_today	", values = { 2 = true, 3 = true, 4 = true } } # check if this is correct
  #   if = { flw2_walking_today = { "!=" = 1 } }

[[observation]]
  name = "seizures"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_seizures_cecoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_seizures_cecoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "seizures"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_seizures", values = { 1 = true, 0 = false } }
  if.any = [{ flw_seizures = 2 }, { flw_seizures = 4 }]

  # [[observation]]
  #   name = "seizures"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_seizures", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_seizures = 2 }, { flw2_seizures = 4 }]

[[observation]]
  name = "abdominal_pain"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_abdopain_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_abdopain_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "conjunctivitis"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_conjunct_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_conjunct_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "skin_rash"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_rash_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_rash_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "skin_rash"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_skin_rash", values = { 1 = true, 0 = false } }
  if.any = [{ flw_skin_rash = 2 }, { flw_skin_rash = 4 }]

  # [[observation]]
  #   name = "skin_rash"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_skin_rash", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_skin_rash = 2 }, { flw2_skin_rash = 4 }]

[[observation]]
  name = "skin_ulcers"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_skinulcers_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_skinulcers_ceoccur_2 = { "!=" = 3 } }

  # [[observation]]
  #   name = "lymphadenopathy"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw_lymp_ceoccur_2", values = { 1 = true, 0 = false } }
  #   if = { lymp_ceoccur_v2 = { "!=" = 3 } }

[[observation]]
  name = "bleeding_haemorrhage"
  date = { ref = "followupDateHierarchy" }
  phase = "followup"
  is_present = { field = "flw_bleed_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_bleed_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "bleeding_haemorrhage"
  date = { ref = "followupDateHierarchy" }
  phase = "followup"
  is_present = { field = "flw_bleeding", values = { 1 = true, 0 = false } }
  if = { flw_bleeding = { "!=" = 2 } }

  # [[observation]]
  #   name = "bleeding_haemorrhage"
  #   date = { ref = "followupDateHierarchy" }
  #   phase = "followup"
  #   is_present = { field = "flw2_bleeding", values = { 1 = true, 0 = false } }
  #   if = { flw2_bleeding = { "!=" = 2 } }

[[observation]]
  name = "loss_of_smell"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_smell_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_smell_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "loss_of_smell"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "cu_smell", values = { 1 = true, 0 = false } }
  if = { cu_smell = { "!=" = 3 } }

[[observation]]
  name = "loss_of_smell"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_loss_of_smell", values = { 1 = true, 0 = false } }
  if.any = [{ flw_loss_of_smell = 2 }, { flw_loss_of_smell = 4 }]

  # [[observation]]
  #   name = "loss_of_smell"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_loss_of_smell", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_loss_of_smell = 2 }, { flw2_loss_of_smell = 4 }]

[[observation]]
  name = "loss_of_taste"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_taste_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_taste_ceoccur_2 = { "!=" = 3 } }

[[observation]]
  name = "loss_of_taste"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "cu_taste", values = { 1 = true, 0 = false } }
  if = { cu_taste = { "!=" = 3 } }

[[observation]]
  name = "loss_of_taste"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_loss_of_taste", values = { 1 = true, 0 = false } }
  if.any = [{ flw_loss_of_taste = 2 }, { flw_loss_of_taste = 4 }]

  # [[observation]]
  #   name = "loss_of_taste"
  #   phase = "followup"
  #   date = { ref = "followupDateHierarchy" }
  #   is_present = { field = "flw2_loss_of_taste", values = { 1 = true, 0 = false } }
  #   if.any = [{ flw2_loss_of_taste = 2 }, { flw2_loss_of_taste = 4 }]

[[observation]]
  name = "lower_chest_wall_indrawing"
  phase = "followup"
  date = { ref = "followupDateHierarchy" }
  is_present = { field = "flw_lowerchest_ceoccur_2", values = { 1 = true, 0 = false } }
  if = { flw_lowerchest_ceoccur_2 = { "!=" = 3 } }
